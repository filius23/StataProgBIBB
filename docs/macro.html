<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>1 Macros | Stata für Fortgeschrittene: Programmieren mit Postestimates, Macros und Schleifen in Stata</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="1 Macros | Stata für Fortgeschrittene: Programmieren mit Postestimates, Macros und Schleifen in Stata" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="1 Macros | Stata für Fortgeschrittene: Programmieren mit Postestimates, Macros und Schleifen in Stata" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Andreas Filser" />


<meta name="date" content="2021-12-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>

<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Stata @ BIBB</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Herzlich Willkommen</a></li>
<li class="chapter" data-level="1" data-path="macro.html"><a href="macro.html"><i class="fa fa-check"></i><b>1</b> Macros</a>
<ul>
<li class="chapter" data-level="1.1" data-path="macro.html"><a href="macro.html#macht-einen-unterschied"><i class="fa fa-check"></i><b>1.1</b> <code>=</code> macht einen Unterschied</a></li>
<li class="chapter" data-level="1.2" data-path="macro.html"><a href="macro.html#local-und-global-sind-getrennte-welten"><i class="fa fa-check"></i><b>1.2</b> <code>local</code> und <code>global</code> sind getrennte Welten</a></li>
<li class="chapter" data-level="1.3" data-path="macro.html"><a href="macro.html#macros-mit-text"><i class="fa fa-check"></i><b>1.3</b> Macros mit Text</a></li>
<li class="chapter" data-level="1.4" data-path="macro.html"><a href="macro.html#dateipfade"><i class="fa fa-check"></i><b>1.4</b> Dateipfade</a></li>
<li class="chapter" data-level="1.5" data-path="macro.html"><a href="macro.html#bereits-definierte-macros"><i class="fa fa-check"></i><b>1.5</b> Bereits definierte Macros</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="macro.html"><a href="macro.html#if"><i class="fa fa-check"></i><b>1.5.1</b> <code>if</code></a></li>
<li class="chapter" data-level="1.5.2" data-path="macro.html"><a href="macro.html#macros-als-variablennamen-und-befehle"><i class="fa fa-check"></i><b>1.5.2</b> Macros als Variablennamen und Befehle</a></li>
<li class="chapter" data-level="1.5.3" data-path="macro.html"><a href="macro.html#allglo"><i class="fa fa-check"></i><b>1.5.3</b> <code>globals</code> durchsuchen</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="macro.html"><a href="macro.html#wenn-nicht-if-dann-else"><i class="fa fa-check"></i><b>1.6</b> Wenn nicht <code>if</code>, dann <code>else</code></a></li>
<li class="chapter" data-level="1.7" data-path="macro.html"><a href="macro.html#schleifen-foreach-forvalues"><i class="fa fa-check"></i><b>1.7</b> Schleifen: <code>foreach</code> &amp; <code>forvalues</code></a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="macro.html"><a href="macro.html#weitere-schleifentypen"><i class="fa fa-check"></i><b>1.7.1</b> Weitere Schleifentypen</a></li>
<li class="chapter" data-level="1.7.2" data-path="macro.html"><a href="macro.html#anwendung"><i class="fa fa-check"></i><b>1.7.2</b> Anwendung</a></li>
<li class="chapter" data-level="1.7.3" data-path="macro.html"><a href="macro.html#schleifen-aufbauen"><i class="fa fa-check"></i><b>1.7.3</b> Schleifen aufbauen</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="macro.html"><a href="macro.html#übungen"><i class="fa fa-check"></i><b>1.8</b> Übungen</a>
<ul>
<li class="chapter" data-level="1.8.1" data-path="macro.html"><a href="macro.html#ue1"><i class="fa fa-check"></i><b>1.8.1</b> Übung</a></li>
<li class="chapter" data-level="1.8.2" data-path="macro.html"><a href="macro.html#ue2"><i class="fa fa-check"></i><b>1.8.2</b> Übung: FizzBuzz-Challenge</a></li>
</ul></li>
<li class="chapter" data-level="1.9" data-path="macro.html"><a href="macro.html#dir"><i class="fa fa-check"></i><b>1.9</b> Windows Dateipfade mit macros</a></li>
<li class="chapter" data-level="1.10" data-path="macro.html"><a href="macro.html#details"><i class="fa fa-check"></i><b>1.10</b> Details</a>
<ul>
<li class="chapter" data-level="1.10.1" data-path="macro.html"><a href="macro.html#local-x-entspricht-global-_x"><i class="fa fa-check"></i><b>1.10.1</b> <code>local x</code> entspricht <code>global _x</code></a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Stata für Fortgeschrittene: Programmieren mit Postestimates, Macros und Schleifen in Stata</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="macro" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Macros</h1>
<p>Macros ist die Sammelbezeichung für <code>global</code>s und <code>local</code>s in Stata.
Beide dienen zur (vorläufigen) Speicherung von Text- oder Zahleninformationen.
Definiert werden sie durch <code>global</code><em>inhalt</em> oder <code>local</code><em>inhalt</em> - oft mit <code>glo</code> und <code>loc</code> als Abkürzungen.
<code>global</code>s können dann mit <code>$globalname</code>/<code>${globalname}</code> aufgerufen werden, <code>local</code>s mit `<code>localname'</code> - ganz einfach bspw. mit <code>dis[play]</code>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb1-1"><a href="macro.html#cb1-1" aria-hidden="true" tabindex="-1"></a>glo x = 1</span>
<span id="cb1-2"><a href="macro.html#cb1-2" aria-hidden="true" tabindex="-1"></a>loc <span class="fu">y</span> = 2</span>
<span id="cb1-3"><a href="macro.html#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="macro.html#cb1-4" aria-hidden="true" tabindex="-1"></a>dis <span class="ot">${x}</span></span>
<span id="cb1-5"><a href="macro.html#cb1-5" aria-hidden="true" tabindex="-1"></a>dis <span class="ot">`y&#39;</span></span></code></pre></div>
<pre><code>1

2</code></pre>
<p>…oder mit <code>macro list</code>, hier sind die macros aber ohne “punctuation” (also <code>$</code> oder `<code>'</code>)</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb3-1"><a href="macro.html#cb3-1" aria-hidden="true" tabindex="-1"></a>glo x = 1</span>
<span id="cb3-2"><a href="macro.html#cb3-2" aria-hidden="true" tabindex="-1"></a>loc <span class="fu">y</span> = 2</span>
<span id="cb3-3"><a href="macro.html#cb3-3" aria-hidden="true" tabindex="-1"></a>mac <span class="ot">list</span> x</span>
<span id="cb3-4"><a href="macro.html#cb3-4" aria-hidden="true" tabindex="-1"></a>mac <span class="ot">list</span> _y</span></code></pre></div>
<pre><code>x:              1

_y:             2</code></pre>
<p>Der Unterschied besteht vor allem darin, dass <em>local</em> macros ‘lokal’ für ein spezifisches Programm verfügbar sind, <em>globale</em> macros hingegen für alle Programme (innerhalb einer Stata-Session) verfügbar sind.
Letztlich können wir jede Instanz, in der wir mehrere Zeilen eines DoFiles ausführen als ‘Programm’ ansehen.</p>
<p><code>global</code>s können wir später nochmal aufrufen, <code>local</code>s nicht:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb5-1"><a href="macro.html#cb5-1" aria-hidden="true" tabindex="-1"></a>mac <span class="ot">list</span> xg</span></code></pre></div>
<pre><code>xg:             1</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb7-1"><a href="macro.html#cb7-1" aria-hidden="true" tabindex="-1"></a>mac <span class="ot">list</span> _xl</span></code></pre></div>
<pre><code>r(111);

end of do-file
r(111);</code></pre>
<div id="macht-einen-unterschied" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> <code>=</code> macht einen Unterschied</h2>
<p>In der Regel können wir auch einfach <code>glo glname Wert</code> bzw. <code>loc locname Wert</code> statt <code>glo glname = Wert</code> bzw. <code>loc locname = Wert</code> angeben.
Allerdings ist hier etwas Vorsicht geboten, denn das <code>=</code> ist entscheidend ob die Rechnung abgelegt wird oder das Ergebnis (<em>Stichwort evaluation</em>):
Im Ergebnis sehen wir hier beides Mal das gleiche:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb9-1"><a href="macro.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">local</span> m1 2+2</span>
<span id="cb9-2"><a href="macro.html#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="kw">display</span> <span class="ot">`m1&#39;</span></span></code></pre></div>
<pre><code>4</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb11-1"><a href="macro.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">local</span> m2 = 2+2</span>
<span id="cb11-2"><a href="macro.html#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="kw">display</span> <span class="ot">`m2&#39;</span></span></code></pre></div>
<pre><code>4</code></pre>
<p>Aber wenn wir uns mit <code>mac list</code> die abgelegten Infos ansehen, dann sehen wir den entscheidenden Unterschied:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb13-1"><a href="macro.html#cb13-1" aria-hidden="true" tabindex="-1"></a>mac <span class="ot">list</span> _m1 _m2</span></code></pre></div>
<pre><code>_m1:            2+2
_m2:            4</code></pre>
<p>Wenn wir nämlich mit <code>m1</code> und <code>m2</code> weiterrechnen, da kann folgendes passieren:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb15-1"><a href="macro.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="kw">local</span> m1 2+2</span>
<span id="cb15-2"><a href="macro.html#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="kw">display</span> <span class="ot">`m1&#39;</span>*4</span></code></pre></div>
<pre><code>10</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb17-1"><a href="macro.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="kw">local</span> m2 = 2+2</span>
<span id="cb17-2"><a href="macro.html#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="kw">display</span> <span class="ot">`m2&#39;</span>*4</span></code></pre></div>
<pre><code>16</code></pre>
<p>Denn <span class="math inline">\(2+2*4\neq4*4\)</span></p>
</div>
<div id="local-und-global-sind-getrennte-welten" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> <code>local</code> und <code>global</code> sind getrennte Welten</h2>
<p>Geht, aber ist nicht zu empfehlen:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb19-1"><a href="macro.html#cb19-1" aria-hidden="true" tabindex="-1"></a>glo <span class="kw">yx</span> = 1</span>
<span id="cb19-2"><a href="macro.html#cb19-2" aria-hidden="true" tabindex="-1"></a>loc <span class="kw">yx</span> = 2</span>
<span id="cb19-3"><a href="macro.html#cb19-3" aria-hidden="true" tabindex="-1"></a>mac <span class="ot">list</span> <span class="kw">yx</span></span>
<span id="cb19-4"><a href="macro.html#cb19-4" aria-hidden="true" tabindex="-1"></a>mac <span class="ot">list</span> _yx</span></code></pre></div>
<pre><code>yx:             1

_yx:            2</code></pre>
</div>
<div id="macros-mit-text" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Macros mit Text</h2>
<p>Wir können macros zu Texten zusammenbauen:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb21-1"><a href="macro.html#cb21-1" aria-hidden="true" tabindex="-1"></a>glo t1 <span class="st">&quot;Hallo&quot;</span></span>
<span id="cb21-2"><a href="macro.html#cb21-2" aria-hidden="true" tabindex="-1"></a>glo t2 <span class="st">&quot; zusammen&quot;</span></span>
<span id="cb21-3"><a href="macro.html#cb21-3" aria-hidden="true" tabindex="-1"></a>glo t3 <span class="st">&quot;! :-)&quot;</span></span>
<span id="cb21-4"><a href="macro.html#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="macro.html#cb21-5" aria-hidden="true" tabindex="-1"></a>glo t4 = <span class="st">&quot;${t1}${t2}${t3}&quot;</span></span>
<span id="cb21-6"><a href="macro.html#cb21-6" aria-hidden="true" tabindex="-1"></a>dis <span class="st">&quot;${t4}&quot;</span></span>
<span id="cb21-7"><a href="macro.html#cb21-7" aria-hidden="true" tabindex="-1"></a>mac <span class="ot">list</span> t1 t2 t3 t4</span></code></pre></div>
<pre><code>Hallo zusammen! :-)

t1:             Hallo
t2:              zusammen
t3:             ! :-)
t4:             Hallo zusammen! :-)</code></pre>
</div>
<div id="dateipfade" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Dateipfade</h2>
<p>Ein macro kann auch Text enthalten und wir können diesen bspw. für Dateipfade macros verwenden:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb23-1"><a href="macro.html#cb23-1" aria-hidden="true" tabindex="-1"></a>glo pfad <span class="st">&quot;D:\Projekt\daten\BIBB_BAuA&quot;</span> <span class="co">// wo liegt der Datensatz?</span></span>
<span id="cb23-2"><a href="macro.html#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="st">&quot;${pfad}/BIBBBAuA_2018_suf1.0.dta&quot;</span>, <span class="kw">clear</span> <span class="co">// laden des Datensatzes </span></span></code></pre></div>
<p>Wir können das auch nutzen, um DoFiles in Kooperationsprojekten zu bauen, wenn verschiedenen Personen die DoFiles verwenden:
<img src="pics/01_pfade.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb24-1"><a href="macro.html#cb24-1" aria-hidden="true" tabindex="-1"></a>glo pfad <span class="st">&quot;C:\Projekte\Micha&quot;</span> <span class="co">// wo liegt der Datensatz bei Alex?</span></span>
<span id="cb24-2"><a href="macro.html#cb24-2" aria-hidden="true" tabindex="-1"></a>glo pfad <span class="st">&quot;D:\Arbeit\Alex&quot;</span>    <span class="co">// wo liegt der Datensatz bei Micha?</span></span>
<span id="cb24-3"><a href="macro.html#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="macro.html#cb24-4" aria-hidden="true" tabindex="-1"></a>glo prog <span class="st">&quot;${pfad}/prog&quot;</span>  </span>
<span id="cb24-5"><a href="macro.html#cb24-5" aria-hidden="true" tabindex="-1"></a>glo <span class="kw">data</span> <span class="st">&quot;${pfad}/data&quot;</span></span>
<span id="cb24-6"><a href="macro.html#cb24-6" aria-hidden="true" tabindex="-1"></a>glo <span class="fu">log</span>  <span class="st">&quot;${pfad}/log&quot;</span></span></code></pre></div>
<p>Micha würde dann immer den Pfad von Alex überspringen/auskommentieren und umgekehrt.
Wir lernen <a href="#ifelse1">gleich</a> noch eine Möglichkeit kennen, das auch direkt mit zu lösen mit dem Usernamen der verwendeten PCs.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb25-1"><a href="macro.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="st">&quot;${data}/BIBBBAuA_2018_suf1.0.dta&quot;</span>, <span class="kw">clear</span> <span class="co">// laden des Datensatzes </span></span></code></pre></div>
<p>Bei Dateipfaden ist <a href="macro.html#dir">jedoch <code>\</code> beim Zusammenbauen mit macros manchmal problematisch</a>). Ggf. hilft hier <code>/</code> statt <code>\</code> zu verwenden.</p>
</div>
<div id="bereits-definierte-macros" class="section level2" number="1.5">
<h2><span class="header-section-number">1.5</span> Bereits definierte Macros</h2>
<p>Mit <code>mac list</code> bekommen wir auch einige von Stata bereits vorgegebenen Macros angezeigt.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb26-1"><a href="macro.html#cb26-1" aria-hidden="true" tabindex="-1"></a>mac <span class="ot">list</span></span></code></pre></div>
<p>Zwei sehr nützliche sind dabei <code>$S_DATE</code> <code>$S_TIME</code> - das aktuelle Datum und die aktuelle Zeit:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb27-1"><a href="macro.html#cb27-1" aria-hidden="true" tabindex="-1"></a>dis <span class="st">&quot;$S_DATE&quot;</span></span>
<span id="cb27-2"><a href="macro.html#cb27-2" aria-hidden="true" tabindex="-1"></a>dis <span class="st">&quot;$S_TIME&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb28-1"><a href="macro.html#cb28-1" aria-hidden="true" tabindex="-1"></a>1 Dec 2021 </span>
<span id="cb28-2"><a href="macro.html#cb28-2" aria-hidden="true" tabindex="-1"></a>12:44:22</span></code></pre></div>
<p>Diese können wir beispielsweise am Anfang und Ende eines LogFiles einblenden, um Start- und Endzeit zu dokumentieren:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb29-1"><a href="macro.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span> <span class="kw">using</span> <span class="st">&quot;${log}/logfile.txt&quot;</span>, t <span class="kw">replace</span></span>
<span id="cb29-2"><a href="macro.html#cb29-2" aria-hidden="true" tabindex="-1"></a>dis <span class="st">&quot;Start: $S_DATE um $S_TIME&quot;</span></span>
<span id="cb29-3"><a href="macro.html#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> ....</span>
<span id="cb29-4"><a href="macro.html#cb29-4" aria-hidden="true" tabindex="-1"></a>.</span>
<span id="cb29-5"><a href="macro.html#cb29-5" aria-hidden="true" tabindex="-1"></a>.</span>
<span id="cb29-6"><a href="macro.html#cb29-6" aria-hidden="true" tabindex="-1"></a>.</span>
<span id="cb29-7"><a href="macro.html#cb29-7" aria-hidden="true" tabindex="-1"></a>.</span>
<span id="cb29-8"><a href="macro.html#cb29-8" aria-hidden="true" tabindex="-1"></a>.</span>
<span id="cb29-9"><a href="macro.html#cb29-9" aria-hidden="true" tabindex="-1"></a>.</span>
<span id="cb29-10"><a href="macro.html#cb29-10" aria-hidden="true" tabindex="-1"></a>dis <span class="st">&quot;Ende: $S_DATE um $S_TIME&quot;</span></span>
<span id="cb29-11"><a href="macro.html#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span> <span class="kw">close</span> </span></code></pre></div>
<p>Außerdem gibt es einige <code>locals</code> mit nützlichen Infos:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb30-1"><a href="macro.html#cb30-1" aria-hidden="true" tabindex="-1"></a>dis <span class="st">&quot;`c(username)&#39;&quot;</span></span>
<span id="cb30-2"><a href="macro.html#cb30-2" aria-hidden="true" tabindex="-1"></a>dis <span class="st">&quot;`c(machine_type)&#39;&quot;</span></span>
<span id="cb30-3"><a href="macro.html#cb30-3" aria-hidden="true" tabindex="-1"></a>dis <span class="st">&quot;`c(os)&#39;&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb31-1"><a href="macro.html#cb31-1" aria-hidden="true" tabindex="-1"></a>Filser</span>
<span id="cb31-2"><a href="macro.html#cb31-2" aria-hidden="true" tabindex="-1"></a>PC (64-bit x86-64)</span>
<span id="cb31-3"><a href="macro.html#cb31-3" aria-hidden="true" tabindex="-1"></a>Windows</span></code></pre></div>
<p>Weitere “system parameters and settings” unter <code>help creturn</code> bspw.:
<code>c(changed)</code> returns a numeric scalar equal to 0 if the dataset in memory has not changed since it was last saved and 1 otherwise.
<code>c(filename)</code> returns a string containing the filename last specified with a use or save, such as <code>"C:\Data\auto.dta"</code>.
<code>c(filedate)</code> returns a string containing the date and time the file in <code>c(filename)</code> was last saved, such as “7 Jul 2016 13:51.”</p>
<div id="if" class="section level3" number="1.5.1">
<h3><span class="header-section-number">1.5.1</span> <code>if</code></h3>
<p>Mit <code>if (</code>local<code>== "...")</code> können wir macros abgleichen, um Befehle nur unter bestimmten Bedingungen auszuführen:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb32-1"><a href="macro.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> (<span class="st">&quot;`c(username)&#39;&quot;</span> == <span class="st">&quot;Filser&quot;</span>)  <span class="kw">display</span> <span class="st">&quot;Du bist Filser&quot;</span></span>
<span id="cb32-2"><a href="macro.html#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> (<span class="st">&quot;`c(username)&#39;&quot;</span> != <span class="st">&quot;Fischer&quot;</span>) <span class="kw">display</span> <span class="st">&quot;Du bist nicht Fischer&quot;</span></span></code></pre></div>
<p>Das können wir für den Fall von eben mit mehreren Nutzern nutzen:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb33-1"><a href="macro.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> (<span class="st">&quot;`c(username)&#39;&quot;</span> == <span class="st">&quot;Alex&quot;</span>)   glo pfad <span class="st">&quot;C:\Projekte\Micha&quot;</span> <span class="co">// wo liegt der Datensatz bei Alex?</span></span>
<span id="cb33-2"><a href="macro.html#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> (<span class="st">&quot;`c(username)&#39;&quot;</span> == <span class="st">&quot;Micha&quot;</span>)  glo pfad <span class="st">&quot;D:\Arbeit\Alex&quot;</span>    <span class="co">// wo liegt der Datensatz bei Micha?</span></span>
<span id="cb33-3"><a href="macro.html#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="macro.html#cb33-4" aria-hidden="true" tabindex="-1"></a>glo prog <span class="st">&quot;${pfad}/prog&quot;</span>  </span>
<span id="cb33-5"><a href="macro.html#cb33-5" aria-hidden="true" tabindex="-1"></a>glo <span class="kw">data</span> <span class="st">&quot;${pfad}/data&quot;</span></span>
<span id="cb33-6"><a href="macro.html#cb33-6" aria-hidden="true" tabindex="-1"></a>glo <span class="fu">log</span>  <span class="st">&quot;${pfad}/log&quot;</span></span>
<span id="cb33-7"><a href="macro.html#cb33-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-8"><a href="macro.html#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="st">&quot;${pfad}/BIBBBAuA_2018_suf1.0.dta&quot;</span>, <span class="kw">clear</span> <span class="co">// laden des Datensatzes </span></span></code></pre></div>
</div>
<div id="macros-als-variablennamen-und-befehle" class="section level3" number="1.5.2">
<h3><span class="header-section-number">1.5.2</span> Macros als Variablennamen und Befehle</h3>
<p>Auch so etwas ist möglich:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb34-1"><a href="macro.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="kw">local</span> n 200</span>
<span id="cb34-2"><a href="macro.html#cb34-2" aria-hidden="true" tabindex="-1"></a>su F<span class="ot">`n&#39;</span></span></code></pre></div>
<pre><code>    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
        F200 |     17,953    36.24272    14.03048          1         99</code></pre>
<p>Ein macro kann auch ein Programm sein:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb36-1"><a href="macro.html#cb36-1" aria-hidden="true" tabindex="-1"></a>loc t <span class="kw">tab</span></span>
<span id="cb36-2"><a href="macro.html#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="ot">`t&#39;</span> zpalter</span></code></pre></div>
<pre><code>Mobilfunkin |
    terview |      Freq.     Percent        Cum.
------------+-----------------------------------
   Festnetz |     14,008       70.00       70.00
  Mobilfunk |      6,004       30.00      100.00
------------+-----------------------------------
      Total |     20,012      100.00</code></pre>
</div>
<div id="allglo" class="section level3" number="1.5.3">
<h3><span class="header-section-number">1.5.3</span> <code>globals</code> durchsuchen</h3>
<p>Mit Hilfe sog. Wildcards können wir Zeichen “offen lassen”:</p>
<p><code>?</code> ersetzt ein Zeichen
<code>*</code> mehrere oder keines</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb38-1"><a href="macro.html#cb38-1" aria-hidden="true" tabindex="-1"></a>glo x1 = 2</span>
<span id="cb38-2"><a href="macro.html#cb38-2" aria-hidden="true" tabindex="-1"></a>glo <span class="kw">x2</span> <span class="st">&quot;das ist x2&quot;</span></span>
<span id="cb38-3"><a href="macro.html#cb38-3" aria-hidden="true" tabindex="-1"></a>glo x 291</span>
<span id="cb38-4"><a href="macro.html#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="kw">global</span> allglo:  <span class="ot">all</span> globals <span class="st">&quot;x*&quot;</span></span>
<span id="cb38-5"><a href="macro.html#cb38-5" aria-hidden="true" tabindex="-1"></a>mac <span class="ot">l</span> allglo</span></code></pre></div>
<pre><code>allglo:         x x2 x1</code></pre>
<p>Hier haben wir auch schon die dritte Form der macro Definition kennengelernt, die sog. <code>extended macro function</code>, welche auf <code>:</code> folgt. Hier also <code>all globals</code>, im Laufe dieses Kurses werden wir noch zahlreiche dieser Funktionen kennenlernen.</p>
<hr />
<p><strong><a href="macro.html#ue1">Übung 1</a></strong></p>
<hr />
</div>
</div>
<div id="wenn-nicht-if-dann-else" class="section level2" number="1.6">
<h2><span class="header-section-number">1.6</span> Wenn nicht <code>if</code>, dann <code>else</code></h2>
<p>Mit <code>if</code> haben wir die Möglichkeiten aber noch nicht ausgeschöpft - aus <code>help if</code>:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb40-1"><a href="macro.html#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> <span class="ot">`n&#39;</span>==1 {</span>
<span id="cb40-2"><a href="macro.html#cb40-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">local</span> <span class="fu">word</span> <span class="st">&quot;one&quot;</span></span>
<span id="cb40-3"><a href="macro.html#cb40-3" aria-hidden="true" tabindex="-1"></a>     }</span>
<span id="cb40-4"><a href="macro.html#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="kw">else</span> <span class="kw">if</span> <span class="ot">`n&#39;</span>==2 {</span>
<span id="cb40-5"><a href="macro.html#cb40-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">local</span> <span class="fu">word</span> <span class="st">&quot;two&quot;</span></span>
<span id="cb40-6"><a href="macro.html#cb40-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-7"><a href="macro.html#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="kw">else</span> <span class="kw">if</span> <span class="ot">`n&#39;</span>==3 {</span>
<span id="cb40-8"><a href="macro.html#cb40-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">local</span> <span class="fu">word</span> <span class="st">&quot;three&quot;</span></span>
<span id="cb40-9"><a href="macro.html#cb40-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-10"><a href="macro.html#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="kw">else</span> {</span>
<span id="cb40-11"><a href="macro.html#cb40-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">local</span> <span class="fu">word</span> <span class="st">&quot;big&quot;</span></span>
<span id="cb40-12"><a href="macro.html#cb40-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-13"><a href="macro.html#cb40-13" aria-hidden="true" tabindex="-1"></a><span class="kw">display</span> <span class="st">&quot;`word&#39;&quot;</span></span></code></pre></div>
<p>Mit <code>exit</code> (<code>help exit_program</code>) können wir Stata zu einer Unterbrechung bringen:</p>
<blockquote>
<p>More generally, exit causes Stata to terminate the current process and returns control to the calling process.</p>
</blockquote>
<div class="sourceCode" id="cb41"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb41-1"><a href="macro.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> <span class="st">&quot;`c(username)&#39;&quot;</span> == <span class="st">&quot;Alex&quot;</span> {</span>
<span id="cb41-2"><a href="macro.html#cb41-2" aria-hidden="true" tabindex="-1"></a>  glo pfad <span class="st">&quot;C:\Projekte\Micha&quot;</span> <span class="co">// wo liegt der Datensatz bei Alex?</span></span>
<span id="cb41-3"><a href="macro.html#cb41-3" aria-hidden="true" tabindex="-1"></a>    } </span>
<span id="cb41-4"><a href="macro.html#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="kw">else</span> <span class="kw">if</span> <span class="st">&quot;`c(username)&#39;&quot;</span> == <span class="st">&quot;Micha&quot;</span> {</span>
<span id="cb41-5"><a href="macro.html#cb41-5" aria-hidden="true" tabindex="-1"></a>  glo pfad <span class="st">&quot;D:\Arbeit\Alex&quot;</span>    <span class="co">// wo liegt der Datensatz bei Micha?</span></span>
<span id="cb41-6"><a href="macro.html#cb41-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-7"><a href="macro.html#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="kw">else</span> {</span>
<span id="cb41-8"><a href="macro.html#cb41-8" aria-hidden="true" tabindex="-1"></a> <span class="kw">display</span> <span class="kw">as</span> <span class="kw">error</span> <span class="st">&quot;Hier fehlt der passende Pfad&quot;</span></span>
<span id="cb41-9"><a href="macro.html#cb41-9" aria-hidden="true" tabindex="-1"></a> <span class="kw">exit</span> </span>
<span id="cb41-10"><a href="macro.html#cb41-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>Hier fehlt der passende Pfad

end of do-file</code></pre>
</div>
<div id="schleifen-foreach-forvalues" class="section level2" number="1.7">
<h2><span class="header-section-number">1.7</span> Schleifen: <code>foreach</code> &amp; <code>forvalues</code></h2>
<p>Schleifen helfen uns das DRY (“Don’t repeat yourself”) Prinzip umzusetzen.</p>
<p>Ein vereinfachtes Syntaxdiagramm der <code>foreach</code>-Schleife sieht so aus:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb43-1"><a href="macro.html#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="kw">foreach</span> <span class="fu">lname</span> listtype <span class="ot">list</span> {</span>
<span id="cb43-2"><a href="macro.html#cb43-2" aria-hidden="true" tabindex="-1"></a>  Befehle</span>
<span id="cb43-3"><a href="macro.html#cb43-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><code>lname</code> steht dabei für ein <code>local</code> macro.</p>
<p>Wir können unterschiedliche Typen von <code>foreach</code>-Listen verwenden:
– <code>of varlist</code>: Variablenlisten
– <code>of newlist</code>: neue Variablen
– <code>of numlist</code>: Nummernlisten - bspw. <code>(0(1)5)</code> <span class="math inline">\(\Rightarrow\)</span> “1 bis 5 in Schritten von 1”
– <code>in</code>: beliebige Listen von Buchstaben, Zahlen oder Wörtern (durch Leerzeichen getrennt)</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb44-1"><a href="macro.html#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="kw">foreach</span> n <span class="kw">of</span> numlist 1/3 6(1)9  {</span>
<span id="cb44-2"><a href="macro.html#cb44-2" aria-hidden="true" tabindex="-1"></a>    dis <span class="st">&quot;`n&#39;&quot;</span></span>
<span id="cb44-3"><a href="macro.html#cb44-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>1
2
3
6
7
8
9</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb46-1"><a href="macro.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="kw">foreach</span> n <span class="kw">of</span> numlist 6 4: -4  {</span>
<span id="cb46-2"><a href="macro.html#cb46-2" aria-hidden="true" tabindex="-1"></a>    dis <span class="st">&quot;`n&#39;&quot;</span></span>
<span id="cb46-3"><a href="macro.html#cb46-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>6
4
2
0
-2
-4</code></pre>
<p>Mit <code>ferest()</code> können wir uns die “noch übrigen Werte in der Liste anzeigen lassen:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb48-1"><a href="macro.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="kw">foreach</span> n <span class="kw">of</span> numlist 1(1)5 {</span>
<span id="cb48-2"><a href="macro.html#cb48-2" aria-hidden="true" tabindex="-1"></a>    dis <span class="st">&quot;`n&#39;&quot;</span></span>
<span id="cb48-3"><a href="macro.html#cb48-3" aria-hidden="true" tabindex="-1"></a>    dis <span class="st">&quot;Es kommen noch: `ferest()&#39;&quot;</span></span>
<span id="cb48-4"><a href="macro.html#cb48-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>1
Es kommen noch: 2 3 4 5
2
Es kommen noch: 3 4 5
3
Es kommen noch: 4 5
4
Es kommen noch: 5
5
Es kommen noch: </code></pre>
<div id="weitere-schleifentypen" class="section level3" number="1.7.1">
<h3><span class="header-section-number">1.7.1</span> Weitere Schleifentypen</h3>
<p>Es gibt außerdem <code>forvalues</code>:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb50-1"><a href="macro.html#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="kw">forvalues</span> <span class="fu">lname</span>=<span class="kw">range</span> {</span>
<span id="cb50-2"><a href="macro.html#cb50-2" aria-hidden="true" tabindex="-1"></a>  Befehle</span>
<span id="cb50-3"><a href="macro.html#cb50-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><code>forvalues</code>-Schleife ist eine <code>foreach</code>-Schleife mit <code>numlist</code>.
Aber: Die <code>foreach</code>-Schleife mit einer <code>numlist</code> funktioniert nicht mit einer beliebig hohen Anzahl von Ziffern.
In der <code>forvalues</code>-Schleife gibt es keine Beschränkung. Außerdem ist <code>forvalues</code>-Schleife schneller im Abarbeiten von Nummernlisten.</p>
<p>Und dann gibt es noch die <code>while</code>-Schleife:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb51-1"><a href="macro.html#cb51-1" aria-hidden="true" tabindex="-1"></a>loc i = 1</span>
<span id="cb51-2"><a href="macro.html#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="kw">while</span> <span class="ot">`i&#39;</span> &lt;= 5 {</span>
<span id="cb51-3"><a href="macro.html#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">display</span> <span class="st">&quot;`i&#39;&quot;</span></span>
<span id="cb51-4"><a href="macro.html#cb51-4" aria-hidden="true" tabindex="-1"></a>  loc i = <span class="ot">`i&#39;</span> + 1</span>
<span id="cb51-5"><a href="macro.html#cb51-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>1
2
3
4
5</code></pre>
<p>Eine Besonderheit bei <code>local</code>s ist, dass wir mit <code>loc ++i</code> den Wert um 1 erhöhen können. Somit führt folgende Syntax zum gleichen Ergebnis:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb53-1"><a href="macro.html#cb53-1" aria-hidden="true" tabindex="-1"></a>loc i = 1</span>
<span id="cb53-2"><a href="macro.html#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="kw">while</span> <span class="ot">`i&#39;</span> &lt;= 5 {</span>
<span id="cb53-3"><a href="macro.html#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">display</span> <span class="st">&quot;`i&#39;&quot;</span></span>
<span id="cb53-4"><a href="macro.html#cb53-4" aria-hidden="true" tabindex="-1"></a>  loc ++i</span>
<span id="cb53-5"><a href="macro.html#cb53-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="anwendung" class="section level3" number="1.7.2">
<h3><span class="header-section-number">1.7.2</span> Anwendung</h3>
<div class="sourceCode" id="cb54"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb54-1"><a href="macro.html#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="kw">foreach</span> v <span class="kw">of</span> numlist 19(5)35 {</span>
<span id="cb54-2"><a href="macro.html#cb54-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="st">&quot;Alter bis `v&#39;&quot;</span></span>
<span id="cb54-3"><a href="macro.html#cb54-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">tab</span> S1 <span class="kw">if</span> zpalter &lt;= <span class="ot">`v&#39;</span></span>
<span id="cb54-4"><a href="macro.html#cb54-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>Alter bis 19

 Geschlecht |      Freq.     Percent        Cum.
------------+-----------------------------------
   mÃ¤nnlich |         41       67.21       67.21
   weiblich |         20       32.79      100.00
------------+-----------------------------------
      Total |         61      100.00
Alter bis 24

 Geschlecht |      Freq.     Percent        Cum.
------------+-----------------------------------
   mÃ¤nnlich |        373       65.10       65.10
   weiblich |        200       34.90      100.00
------------+-----------------------------------
      Total |        573      100.00
Alter bis 29

 Geschlecht |      Freq.     Percent        Cum.
------------+-----------------------------------
   mÃ¤nnlich |        991       60.46       60.46
   weiblich |        648       39.54      100.00
------------+-----------------------------------
      Total |      1,639      100.00
Alter bis 34

 Geschlecht |      Freq.     Percent        Cum.
------------+-----------------------------------
   mÃ¤nnlich |      1,984       59.03       59.03
   weiblich |      1,377       40.97      100.00
------------+-----------------------------------
      Total |      3,361      100.00</code></pre>
<p>…oder mit <code>inrange()</code>, um lediglich die 5-Jahresaltersgruppe anzuzeigen:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb56-1"><a href="macro.html#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="kw">foreach</span> v <span class="kw">of</span> numlist 19(5)35 {</span>
<span id="cb56-2"><a href="macro.html#cb56-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="st">&quot;Alter &quot;</span> <span class="ot">`v&#39;</span> - 4 <span class="st">&quot; bis &quot;</span> <span class="ot">`v&#39;</span></span>
<span id="cb56-3"><a href="macro.html#cb56-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">tab</span> S1 <span class="kw">if</span> <span class="fu">inrange</span>(zpalter,<span class="ot">`v&#39;</span>-4, <span class="ot">`v&#39;</span>)</span>
<span id="cb56-4"><a href="macro.html#cb56-4" aria-hidden="true" tabindex="-1"></a>    *su zpalter <span class="kw">if</span> <span class="fu">inrange</span>(zpalter,<span class="ot">`v&#39;</span>-4, <span class="ot">`v&#39;</span>)</span>
<span id="cb56-5"><a href="macro.html#cb56-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>Alter 15 bis 19

 Geschlecht |      Freq.     Percent        Cum.
------------+-----------------------------------
   mÃ¤nnlich |         41       67.21       67.21
   weiblich |         20       32.79      100.00
------------+-----------------------------------
      Total |         61      100.00
Alter 20 bis 24

 Geschlecht |      Freq.     Percent        Cum.
------------+-----------------------------------
   mÃ¤nnlich |        332       64.84       64.84
   weiblich |        180       35.16      100.00
------------+-----------------------------------
      Total |        512      100.00
Alter 25 bis 29

 Geschlecht |      Freq.     Percent        Cum.
------------+-----------------------------------
   mÃ¤nnlich |        618       57.97       57.97
   weiblich |        448       42.03      100.00
------------+-----------------------------------
      Total |      1,066      100.00
Alter 30 bis 34

 Geschlecht |      Freq.     Percent        Cum.
------------+-----------------------------------
   mÃ¤nnlich |        993       57.67       57.67
   weiblich |        729       42.33      100.00
------------+-----------------------------------
      Total |      1,722      100.00</code></pre>
</div>
<div id="schleifen-aufbauen" class="section level3" number="1.7.3">
<h3><span class="header-section-number">1.7.3</span> Schleifen aufbauen</h3>
<p>Einfache Schleife mit <code>if</code>/<code>else</code>: ist Zahl gerade oder ungerade?</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb58-1"><a href="macro.html#cb58-1" aria-hidden="true" tabindex="-1"></a>loc n = 5</span>
<span id="cb58-2"><a href="macro.html#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> <span class="fu">trunc</span>(<span class="ot">`n&#39;</span>/2) == <span class="ot">`n&#39;</span>/2 <span class="kw">display</span> <span class="st">&quot;ja&quot;</span></span>
<span id="cb58-3"><a href="macro.html#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> <span class="fu">trunc</span>(<span class="ot">`n&#39;</span>/2) != <span class="ot">`n&#39;</span>/2 <span class="kw">display</span> <span class="st">&quot;nein&quot;</span></span>
<span id="cb58-4"><a href="macro.html#cb58-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-5"><a href="macro.html#cb58-5" aria-hidden="true" tabindex="-1"></a>loc n = 5</span>
<span id="cb58-6"><a href="macro.html#cb58-6" aria-hidden="true" tabindex="-1"></a>dis <span class="fu">mod</span>(<span class="ot">`n&#39;</span>,2) </span>
<span id="cb58-7"><a href="macro.html#cb58-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-8"><a href="macro.html#cb58-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-9"><a href="macro.html#cb58-9" aria-hidden="true" tabindex="-1"></a><span class="kw">forvalues</span> n = 1/10 {</span>
<span id="cb58-10"><a href="macro.html#cb58-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span>  <span class="fu">mod</span>(<span class="ot">`n&#39;</span>,2)  == 0 dis <span class="st">&quot;`n&#39; ist gerade&quot;</span></span>
<span id="cb58-11"><a href="macro.html#cb58-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span>  <span class="fu">mod</span>(<span class="ot">`n&#39;</span>,2)  == 1 dis <span class="st">&quot;`n&#39; ist ungerade&quot;</span></span>
<span id="cb58-12"><a href="macro.html#cb58-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb58-13"><a href="macro.html#cb58-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-14"><a href="macro.html#cb58-14" aria-hidden="true" tabindex="-1"></a><span class="kw">forvalues</span> n = 1/10 {</span>
<span id="cb58-15"><a href="macro.html#cb58-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span>  <span class="fu">mod</span>(<span class="ot">`n&#39;</span>,2)  == 0 {</span>
<span id="cb58-16"><a href="macro.html#cb58-16" aria-hidden="true" tabindex="-1"></a>        dis <span class="st">&quot;`n&#39; ist gerade&quot;</span></span>
<span id="cb58-17"><a href="macro.html#cb58-17" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb58-18"><a href="macro.html#cb58-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">else</span> <span class="kw">if</span> <span class="fu">mod</span>(<span class="ot">`n&#39;</span>,2)  == 1 {</span>
<span id="cb58-19"><a href="macro.html#cb58-19" aria-hidden="true" tabindex="-1"></a>        dis <span class="st">&quot;`n&#39; ist ungerade&quot;</span></span>
<span id="cb58-20"><a href="macro.html#cb58-20" aria-hidden="true" tabindex="-1"></a>    } </span>
<span id="cb58-21"><a href="macro.html#cb58-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">else</span> {</span>
<span id="cb58-22"><a href="macro.html#cb58-22" aria-hidden="true" tabindex="-1"></a>        <span class="kw">display</span> <span class="kw">as</span> <span class="kw">error</span> <span class="st">&quot;hier ging was schief&quot;</span></span>
<span id="cb58-23"><a href="macro.html#cb58-23" aria-hidden="true" tabindex="-1"></a>        <span class="kw">exit</span> </span>
<span id="cb58-24"><a href="macro.html#cb58-24" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb58-25"><a href="macro.html#cb58-25" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><a href="https://de.wikipedia.org/wiki/Division_mit_Rest#Modulo">mod() ist der Modulo-Operator ist Stata - es wird der “Rest” berechnet</a></p>
<hr />
<p><strong><a href="macro.html#ue2">Übung 2</a></strong></p>
<hr />
<ul>
<li>Variablen &amp; value labels anzeigen/bearbeiten</li>
<li>Creating interaction variables</li>
<li>Fitting models with alternative measures of education</li>
<li>Recoding multiple variables the same way</li>
<li>Creating a macro that holds accumulated information</li>
<li>Retrieving information returned by Stata</li>
</ul>
</div>
</div>
<div id="übungen" class="section level2" number="1.8">
<h2><span class="header-section-number">1.8</span> Übungen</h2>
<div id="ue1" class="section level3" number="1.8.1">
<h3><span class="header-section-number">1.8.1</span> Übung</h3>
<ul>
<li>Pfad zusammenbauen für <code>use</code>: Erstellen Sie den Pfad für den <code>use</code>-Befehl schrittweise und unter Berücksichtigung ihres Usernamens.
<ul>
<li>ggf. Dateiverzeichnis einrichten mit Ordner <em>log</em>, <em>prog</em> und <em>data</em> (gerne auch mehr oder andere Namen)</li>
<li>Legen Sie die Erwerbstätigenbefragung 2018 in den <em>data</em>-Ordner (oder dessen Äquivalent)</li>
<li>Wie ist der Username auf Ihrem Gerät?</li>
<li>Verwenden Sie ein <code>if</code>-Statement, um den Dateipfad zu erstellen</li>
</ul></li>
</ul>
</div>
<div id="ue2" class="section level3" number="1.8.2">
<h3><span class="header-section-number">1.8.2</span> Übung: FizzBuzz-Challenge</h3>
<p>Fizz Buzz wird/wurde ein Screening-Instrument für Programmierer*innen verwendet. Fizz Buzz ist ein Kinderlernspiel, bei dem die Kinder üblicherweise im Kreis sitzen und reihum laut von eins aufwärts zählen. Allerdings gibt es zwei Regeln:</p>
<ul>
<li><p>Dabei müssen alle Zahlen, die durch drei teilbar sind, durch das Wort Fizz ersetzt werden und alle Zahlen, die durch fünf teilbar sind, durch das Wort Buzz.</p></li>
<li><p>Wenn eine Zahl durch drei und fünf teilbar ist, dann wird Fizz Buzz gerufen.</p></li>
<li><p><code>if</code> &amp; <code>else</code> für Schleife</p>
<ul>
<li>1-10: bei geraden Zahlen “gerade” und bei ungeraden Zahlen “ungerade” anzeigen
Die</li>
</ul></li>
</ul>
</div>
</div>
<div id="dir" class="section level2" number="1.9">
<h2><span class="header-section-number">1.9</span> Windows Dateipfade mit macros</h2>
<p><a href="https://www.stata.com/manuals/u18.pdf#u18.3.11">Aus der Stata-Doku zu macros</a>:</p>
<p>Stata uses the  character to tell its parser not to expand macros.
Windows uses the  character as the directory path separator.
Mostly, there is no problem using a  in a filename. However, if you are writing a program that contains a Windows path in macro path and a filename in fname, do not assemble the final result as <code>‘path’\‘fname’</code> because Stata will interpret the  as an instruction to not expand <code>‘fname’</code>.
Instead, assemble the final result as <code>‘path’/‘fname’</code>.
Stata understands <code>/</code> as a directory separator on all platforms.</p>
<p><span class="math inline">\(\Rightarrow\)</span></p>
</div>
<div id="details" class="section level2" number="1.10">
<h2><span class="header-section-number">1.10</span> Details</h2>
<div id="local-x-entspricht-global-_x" class="section level3" number="1.10.1">
<h3><span class="header-section-number">1.10.1</span> <code>local x</code> entspricht <code>global _x</code></h3>
<p>Theoretisch kann man auch mit <code>global _x</code> einen <code>local x</code> erzeugen:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb59-1"><a href="macro.html#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="kw">local</span>   x = 2</span>
<span id="cb59-2"><a href="macro.html#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="kw">global</span> _x = 3</span>
<span id="cb59-3"><a href="macro.html#cb59-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-4"><a href="macro.html#cb59-4" aria-hidden="true" tabindex="-1"></a>dis </span></code></pre></div>
<div class="sourceCode" id="cb60"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb60-1"><a href="macro.html#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="kw">local</span> i=1 </span>
<span id="cb60-2"><a href="macro.html#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="kw">global</span> _i=1</span></code></pre></div>
<p>Damit könnte man auch so alle <code>locals</code> auflisten:</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb61-1"><a href="macro.html#cb61-1" aria-hidden="true" tabindex="-1"></a>glo x1 = 2</span>
<span id="cb61-2"><a href="macro.html#cb61-2" aria-hidden="true" tabindex="-1"></a>glo <span class="kw">x2</span> <span class="st">&quot;das ist x2&quot;</span></span>
<span id="cb61-3"><a href="macro.html#cb61-3" aria-hidden="true" tabindex="-1"></a>glo x 291</span>
<span id="cb61-4"><a href="macro.html#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="kw">global</span> allglo:  <span class="ot">all</span> globals <span class="st">&quot;_x*&quot;</span></span>
<span id="cb61-5"><a href="macro.html#cb61-5" aria-hidden="true" tabindex="-1"></a>mac <span class="ot">l</span> allglo</span></code></pre></div>
<div class="sourceCode" id="cb62"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb62-1"><a href="macro.html#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="kw">global</span> a <span class="st">&quot;myvar&quot;</span></span>
<span id="cb62-2"><a href="macro.html#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="kw">gen</span> <span class="ot">$a</span> = oldvar   <span class="kw">gen</span> myvar = oldvar</span>
<span id="cb62-3"><a href="macro.html#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="kw">gen</span> a = oldvar    <span class="kw">gen</span> a = oldvar</span>
<span id="cb62-4"><a href="macro.html#cb62-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-5"><a href="macro.html#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="kw">local</span> a <span class="st">&quot;myvar&quot;</span></span>
<span id="cb62-6"><a href="macro.html#cb62-6" aria-hidden="true" tabindex="-1"></a><span class="kw">gen</span> ‘a’ = oldvar <span class="kw">gen</span> myvar = oldvar</span>
<span id="cb62-7"><a href="macro.html#cb62-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-8"><a href="macro.html#cb62-8" aria-hidden="true" tabindex="-1"></a><span class="kw">gen</span> a = oldvar <span class="kw">gen</span> a = oldvar</span>
<span id="cb62-9"><a href="macro.html#cb62-9" aria-hidden="true" tabindex="-1"></a><span class="kw">global</span> a <span class="st">&quot;newvar&quot;</span></span>
<span id="cb62-10"><a href="macro.html#cb62-10" aria-hidden="true" tabindex="-1"></a><span class="kw">global</span> i = 2</span>
<span id="cb62-11"><a href="macro.html#cb62-11" aria-hidden="true" tabindex="-1"></a><span class="kw">gen</span> <span class="ot">$a$i</span> = oldvar <span class="kw">gen</span> newvar2 = oldvar</span>
<span id="cb62-12"><a href="macro.html#cb62-12" aria-hidden="true" tabindex="-1"></a><span class="kw">local</span> a <span class="st">&quot;newvar&quot;</span></span>
<span id="cb62-13"><a href="macro.html#cb62-13" aria-hidden="true" tabindex="-1"></a><span class="kw">local</span> i = 2</span>
<span id="cb62-14"><a href="macro.html#cb62-14" aria-hidden="true" tabindex="-1"></a><span class="kw">gen</span> ‘a’‘i’ = oldvar <span class="kw">gen</span> newvar2 = oldvar</span>
<span id="cb62-15"><a href="macro.html#cb62-15" aria-hidden="true" tabindex="-1"></a><span class="kw">global</span> b1 <span class="st">&quot;newvar&quot;</span></span>
<span id="cb62-16"><a href="macro.html#cb62-16" aria-hidden="true" tabindex="-1"></a><span class="kw">global</span> i=1</span>
<span id="cb62-17"><a href="macro.html#cb62-17" aria-hidden="true" tabindex="-1"></a><span class="kw">gen</span> <span class="ot">${b$i}</span> = oldvar <span class="kw">gen</span> newvar = oldvar</span>
<span id="cb62-18"><a href="macro.html#cb62-18" aria-hidden="true" tabindex="-1"></a><span class="kw">local</span> b1 <span class="st">&quot;newvar&quot;</span></span>
<span id="cb62-19"><a href="macro.html#cb62-19" aria-hidden="true" tabindex="-1"></a><span class="kw">local</span> i=1</span>
<span id="cb62-20"><a href="macro.html#cb62-20" aria-hidden="true" tabindex="-1"></a><span class="kw">gen</span> ‘b‘i’’ = oldvar <span class="kw">gen</span> newvar = oldvar</span>
<span id="cb62-21"><a href="macro.html#cb62-21" aria-hidden="true" tabindex="-1"></a><span class="kw">global</span> b1 <span class="st">&quot;newvar&quot;</span></span>
<span id="cb62-22"><a href="macro.html#cb62-22" aria-hidden="true" tabindex="-1"></a><span class="kw">global</span> a <span class="st">&quot;b&quot;</span></span>
<span id="cb62-23"><a href="macro.html#cb62-23" aria-hidden="true" tabindex="-1"></a><span class="kw">global</span> i = 1</span>
<span id="cb62-24"><a href="macro.html#cb62-24" aria-hidden="true" tabindex="-1"></a><span class="kw">gen</span> <span class="ot">${$a$i}</span> = oldvar <span class="kw">gen</span> newvar = oldvar</span>
<span id="cb62-25"><a href="macro.html#cb62-25" aria-hidden="true" tabindex="-1"></a><span class="kw">local</span> b1 <span class="st">&quot;newvar&quot;</span></span>
<span id="cb62-26"><a href="macro.html#cb62-26" aria-hidden="true" tabindex="-1"></a><span class="kw">local</span> a <span class="st">&quot;b&quot;</span></span>
<span id="cb62-27"><a href="macro.html#cb62-27" aria-hidden="true" tabindex="-1"></a><span class="kw">local</span> i = 1</span>
<span id="cb62-28"><a href="macro.html#cb62-28" aria-hidden="true" tabindex="-1"></a><span class="kw">gen</span> ‘‘a’‘i’’ = oldvar <span class="kw">gen</span> newvar = oldvar</span></code></pre></div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Stata Tables BIBB.pdf", "Stata Tables BIBB.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
